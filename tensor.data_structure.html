<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Arraymancer - data_structure</title>

  <link href="docutils.css" rel="stylesheet" type="text/css"/>
  <link href="nav.css" rel="stylesheet" type="text/css"/>

  <link href='http://fonts.googleapis.com/css?family=Raleway:400,600,900' rel='stylesheet' type='text/css'/>
  <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>
</head>
<body>
<a href="https://github.com/mratsim/arraymancer"><img style="position: fixed; top: 0; right: 0; border: 0; z-index: 10;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
<header>
  <a class="pagetitle" href="index.html">Arraymancer</a>
  <span>
    <a href="#">Technical reference</a>
    <ul class="monospace">
      <span>
        <a href="#">Core tensor API</a>
        <ul class="monospace">
          <li><a href="tensor.accessors_macros_read.html">tensor.accessors_macros_read</a></li>
          <li><a href="tensor.accessors_macros_syntax.html">tensor.accessors_macros_syntax</a></li>
          <li><a href="tensor.accessors_macros_write.html">tensor.accessors_macros_write</a></li>
          <li><a href="tensor.accessors.html">tensor.accessors</a></li>
          <li><a href="tensor.aggregate.html">tensor.aggregate</a></li>
          <li><a href="tensor.comparison.html">tensor.comparison</a></li>
          <li><a href="tensor.data_structure.html">tensor.data_structure</a></li>
          <li><a href="tensor.display.html">tensor.display</a></li>
          <li><a href="tensor.display_cuda.html">tensor.display_cuda</a></li>
          <li><a href="tensor.exporting.html">tensor.exporting</a></li>
          <li><a href="tensor.filling_data.html">tensor.filling_data</a></li>
          <li><a href="tensor.higher_order_applymap.html">tensor.higher_order_applymap</a></li>
          <li><a href="tensor.higher_order_foldreduce.html">tensor.higher_order_foldreduce</a></li>
          <li><a href="tensor.init_cpu.html">tensor.init_cpu</a></li>
          <li><a href="tensor.init_cuda.html">tensor.init_cuda</a></li>
          <li><a href="tensor.init_opencl.html">tensor.init_opencl</a></li>
          <li><a href="tensor.init_copy_cpu.html">tensor.init_copy_cpu</a></li>
          <li><a href="tensor.init_copy_cuda.html">tensor.init_copy_cuda</a></li>
          <li><a href="tensor.lapack.html">tensor.lapack</a></li>
          <li><a href="tensor.math_functions.html">tensor.math_functions</a></li>
          <li><a href="tensor.operators_blas_l1.html">tensor.operators_blas_l1</a></li>
          <li><a href="tensor.operators_blas_l1_cuda.html">tensor.operators_blas_l1_cuda</a></li>
          <li><a href="tensor.operators_blas_l1_opencl.html">tensor.operators_blas_l1_opencl</a></li>
          <li><a href="tensor.operators_blas_l2l3.html">tensor.operators_blas_l2l3</a></li>
          <li><a href="tensor.operators_blas_l2l3_cuda.html">tensor.operators_blas_l2l3_cuda</a></li>
          <li><a href="tensor.operators_blas_l2l3_opencl.html">tensor.operators_blas_l2l3_opencl</a></li>
          <li><a href="tensor.operators_broadcasted.html">tensor.operators_broadcasted</a></li>
          <li><a href="tensor.operators_broadcasted_cuda.html">tensor.operators_broadcasted_cuda</a></li>
          <li><a href="tensor.operators_broadcasted_opencl.html">tensor.operators_broadcasted_opencl</a></li>
          <li><a href="tensor.operators_comparison.html">tensor.operators_comparison</a></li>
          <li><a href="tensor.operators_logical.html">tensor.operators_logical</a></li>
          <li><a href="tensor.optim_ops_fusion.html">tensor.optim_ops_fusion</a></li>
          <li><a href="tensor.shapeshifting.html">tensor.shapeshifting</a></li>
          <li><a href="tensor.shapeshifting_cuda.html">tensor.shapeshifting_cuda</a></li>
          <li><a href="tensor.shapeshifting_opencl.html">tensor.shapeshifting_opencl</a></li>
          <li><a href="tensor.syntactic_sugar.html">tensor.syntactic_sugar</a></li>
          <li><a href="tensor.ufunc.html">tensor.ufunc</a></li>
        </ul>
      </span>
      <span>
        <a href="#">Neural network API</a>
        <ul class="monospace">
          <li><a href="nn_dsl.dsl_core.html">Neural network: Declaration</a></li>
          <li><a href="nn_activation.relu.html">Activation: Relu (Rectified linear Unit)</a></li>
          <li><a href="nn_activation.sigmoid.html">Activation: Sigmoid</a></li>
          <li><a href="nn_activation.tanh.html">Activation: Tanh</a></li>
          <li><a href="nn_layers.conv2D.html">Layers: Convolution 2D</a></li>
          <li><a href="nn_layers.embedding.html">Layers: Embedding</a></li>
          <li><a href="nn_layers.gru.html">Layers: GRU (Gated Linear Unit)</a></li>
          <li><a href="nn_layers.linear.html">Layers: Linear/Dense</a></li>
          <li><a href="nn_layers.maxpool2D.html">Layers: Maxpool 2D</a></li>
          <li><a href="nn_loss.cross_entropy_losses.html">Loss: Cross-Entropy losses</a></li>
          <li><a href="nn_loss.mean_square_error_loss.html">Loss: Mean Square Error</a></li>
          <li><a href="nn_optimizers.optimizers.html">Optimizers</a></li>
          <li><a href="nn_shapeshifting.reshape_flatten.html">Reshape & Flatten</a></li>
        </ul>
      </span>
      <span>
        <a href="#">Linear algebra, stats, ML</a>
        <ul class="monospace">
          <li><a href="la.decomposition.html">Eigenvalue decomposition</a></li>
          <li><a href="la.decomposition_rand.html">Randomized Truncated SVD</a></li>
          <li><a href="la.least_squares.html">Least squares solver</a></li>
          <li><a href="la.linear_systems.html">Linear systems solver</a></li>
          <li><a href="la.special_matrices.html">Special linear algebra matrices</a></li>
          <li><a href="stats.stats.html">Statistics</a></li>
          <li><a href="ml.pca.html">Principal Component Analysis (PCA)</a></li>
          <li><a href="ml.accuracy_score.html">Accuracy score</a></li>
          <li><a href="ml.common_error_functions.html">Common errors, MAE and MSE (L1, L2 loss)</a></li>
          <li><a href="ml.kmeans.html">K-Means</a></li>
        </ul>
      </span>
      <span>
        <a href="#">IO & Datasets</a>
        <ul class="monospace">
          <li><a href="datasets.mnist.html">MNIST</a></li>
          <li><a href="datasets.imdb.html">IMDB</a></li>
          <li><a href="io.io_csv.html">CSV reading and writing</a></li>
          <li><a href="io.io_hdf5.html">HDF5 files reading and writing</a></li>
          <li><a href="io.io_image.html">Images reading and writing</a></li>
          <li><a href="io.io_npy.html">Numpy files reading and writing</a></li>
        </ul>
      </span>
      <span>
        <a href="#">Autograd</a>
        <ul class="monospace">
          <li><a href="ag.autograd_common.html">Data structure</a></li>
          <li><a href="ag.gates_basic.html">Basic operations</a></li>
          <li><a href="ag.gates_blas.html">Linear algebra operations</a></li>
          <li><a href="ag.gates_hadamard.html">Hadamard product (elementwise matrix multiply)</a></li>
          <li><a href="ag.gates_reduce.html">Reduction operations</a></li>
          <li><a href="ag.gates_shapeshifting_concat_split.html">Concatenation, stacking, splitting, chunking operations</a></li>
          <li><a href="ag.gates_shapeshifting_views.html">Linear algebra operations</a></li>
        </ul>
      </span>
      <span>
        <a href="#">Neuralnet primitives</a>
        <ul class="monospace">
          <li><a href="nnp.nnp_activation.html">Activations</a></li>
          <li><a href="nnp.nnp_convolution.html">Convolution 2D</a></li>
          <li><a href="nnp.nnp_conv2D_cudnn.html">Convolution 2D - CuDNN</a></li>
          <li><a href="nnp.nnp_embedding.html">Linear / Dense layer</a></li>
          <li><a href="nnp.nnp_gru.html">Linear / Dense layer</a></li>
          <li><a href="nnp.nnp_linear.html">Linear / Dense layer</a></li>
          <li><a href="nnp.nnp_maxpooling.html">Maxpooling</a></li>
          <li><a href="nnp.nnp_numerical_gradient.html">Numerical gradient</a></li>
          <li><a href="nnp.nnp_sigmoid_cross_entropy.html">Sigmoid Cross-Entropy loss</a></li>
          <li><a href="nnp.nnp_softmax_cross_entropy.html">Softmax Cross-Entropy loss</a></li>
          <li><a href="nnp.nnp_softmax.html">Softmax</a></li>
        </ul>
      </span>
    </ul>
  </span>
  <span>
    <a href="#">Tutorial</a>
    <ul class="monospace">
      <li><a href="tuto.first_steps.html">First steps</a></li>
      <li><a href="tuto.slicing.html">Taking a slice of a tensor</a></li>
      <li><a href="tuto.linear_algebra.html">Matrix & vectors operations</a></li>
      <li><a href="tuto.broadcasting.html">Broadcasted operations</a></li>
      <li><a href="tuto.shapeshifting.html">Transposing, Reshaping, Permuting, Concatenating</a></li>
      <li><a href="tuto.map_reduce.html">Map & Reduce</a></li>
      <li><a href="tuto.iterators.html">Basic iterators</a></li>
    </ul>
  </span>
  <span>
    <a href="#">Spellbook (How-To&apos;s)</a>
    <ul class="monospace">
      <li><a href="howto.type_conversion.html">How to convert a Tensor type?</a></li>
      <li><a href="howto.ufunc.html">How to create a new universal function?</a></li>
      <li><a href="howto.perceptron.html">How to create a multilayer perceptron?</a></li>
    </ul>
  </span>
  <span>
    <a href="#">Under the hood</a>
    <ul class="monospace">
      <li><a href="uth.speed.html">How Arraymancer achieves its speed?</a></li>
      <li><a href="uth.copy_semantics.html">Why does `=` share data by default aka reference semantics?</a></li>
      <li><a href="uth.opencl_cuda_nim.html">Working with OpenCL and Cuda in Nim</a></li>
    </ul>
  </span>
</header>
<article id="documentId">
  <div class="container">
    <h1 class="title">data_structure</h1>
    <div class="row">
  <div class="three columns">
  <div id="global-links">
    <ul class="simple">
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#CpuStorage"
    title="CpuStorage[T] {.shallow.} = object
  Fdata*: seq[T]"><wbr />Cpu<wbr />Storage<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#Tensor"
    title="Tensor[T] = object
  shape*: MetadataArray
  strides*: MetadataArray
  offset*: int
  storage*: CpuStorage[T]"><wbr />Tensor<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#CudaStorage"
    title="CudaStorage[T] = object
  Flen*: int
  Fdata*: ptr UncheckedArray[T]
  Fref_tracking*: ref [ptr UncheckedArray[T]]"><wbr />Cuda<wbr />Storage<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#CudaTensor"
    title="CudaTensor[T] = object
  shape*: MetadataArray
  strides*: MetadataArray
  offset*: int
  storage*: CudaStorage[T]"><wbr />Cuda<wbr />Tensor<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#ClStorage"
    title="ClStorage[T] = object
  Flen*: int
  Fdata*: ptr UncheckedArray[T]
  Fref_tracking*: ref [ptr UncheckedArray[T]]"><wbr />Cl<wbr />Storage<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#ClTensor"
    title="ClTensor[T] = object
  shape*: MetadataArray
  strides*: MetadataArray
  offset*: int
  storage*: ClStorage[T]"><wbr />Cl<wbr />Tensor<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#AnyTensor"
    title="AnyTensor[T] = Tensor[T] or CudaTensor[T] or ClTensor[T]"><wbr />Any<wbr />Tensor<span class="attachedType"></span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#data%2CTensor%5BT%5D"
    title="data[T](t: Tensor[T]): seq[T]"><wbr />data<span class="attachedType">Tensor</span></a></li>
  <li><a class="reference" href="#data%2CTensor%5BT%5D_2"
    title="data[T](t: var Tensor[T]): var seq[T]"><wbr />data<span class="attachedType">Tensor</span></a></li>
  <li><a class="reference" href="#data%3D%2CTensor%5BT%5D%2Cseq%5BT%5D%5BT%5D"
    title="data=[T](t: var Tensor[T]; s: seq[T])"><wbr />data=<span class="attachedType">Tensor</span></a></li>
  <li><a class="reference" href="#rank%2CAnyTensor"
    title="rank(t: AnyTensor): int"><wbr />rank<span class="attachedType">AnyTensor</span></a></li>
  <li><a class="reference" href="#size%2CAnyTensor"
    title="size(t: AnyTensor): int"><wbr />size<span class="attachedType">AnyTensor</span></a></li>
  <li><a class="reference" href="#shape_to_strides%2CMetadataArray%2COrderType%2CMetadataArray"
    title="shape_to_strides(shape: MetadataArray; layout: OrderType = rowMajor;
                 result: var MetadataArray)"><wbr />shape_<wbr />to_<wbr />strides<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#is_C_contiguous%2CAnyTensor"
    title="is_C_contiguous(t: AnyTensor): bool"><wbr />is_<wbr />C_<wbr />contiguous<span class="attachedType">AnyTensor</span></a></li>
  <li><a class="reference" href="#is_F_contiguous%2CAnyTensor"
    title="is_F_contiguous(t: AnyTensor): bool"><wbr />is_<wbr />F_<wbr />contiguous<span class="attachedType">AnyTensor</span></a></li>
  <li><a class="reference" href="#isContiguous%2CAnyTensor"
    title="isContiguous(t: AnyTensor): bool"><wbr />is<wbr />Contiguous<span class="attachedType">AnyTensor</span></a></li>
  <li><a class="reference" href="#get_data_ptr%2CAnyTensor%5BT%5D"
    title="get_data_ptr[T](t: AnyTensor[T]): ptr T"><wbr />get_<wbr />data_<wbr />ptr<span class="attachedType">AnyTensor</span></a></li>
  <li><a class="reference" href="#get_offset_ptr%2CAnyTensor%5BT%5D"
    title="get_offset_ptr[T](t: AnyTensor[T]): ptr T"><wbr />get_<wbr />offset_<wbr />ptr<span class="attachedType">AnyTensor</span></a></li>
  <li><a class="reference" href="#dataArray%2CTensor%5BT%5D"
    title="dataArray[T](t: Tensor[T]): ptr UncheckedArray[T]"><wbr />data<wbr />Array<span class="attachedType">Tensor</span></a></li>

  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc"></p>
  <div class="section" id="6">
<h1><a class="toc-backref" href="#6">Imports</a></h1>
<dl class="item">
<a class="reference external" href="metadataArray.html">metadataArray</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="CpuStorage"></a>
<dt><pre><a href="data_structure.html#CpuStorage"><span class="Identifier">CpuStorage</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">shallow</span></span><span class="Other">.}</span></span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">Fdata</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span>
</pre></dt>
<dd>

Opaque data storage for Tensors Currently implemented as a seq with reference semantics (shallow copy on assignment). It may change in the future for a custom memory managed and 64 bit aligned solution.<dl class="docutils"><dt>Warning ⚠:</dt>
<dd>Do not use Fdata directly, direct access will be removed in 0.4.0.</dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L21"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L21" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="Tensor"></a>
<dt><pre><a href="data_structure.html#Tensor"><span class="Identifier">Tensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">shape</span><span class="Operator">*</span><span class="Other">:</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a>
  <span class="Identifier">strides</span><span class="Operator">*</span><span class="Other">:</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a>
  <span class="Identifier">offset</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>
  <span class="Identifier">storage</span><span class="Operator">*</span><span class="Other">:</span> <a href="data_structure.html#CpuStorage"><span class="Identifier">CpuStorage</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span>
</pre></dt>
<dd>

<dl class="docutils"><dt>Tensor data structure stored on Cpu</dt>
<dd><ul class="simple"><li><tt class="docutils literal"><span class="pre">shape</span></tt>: Dimensions of the tensor</li>
<li><tt class="docutils literal"><span class="pre">strides</span></tt>: Numbers of items to skip to get the next item along a dimension.</li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: Offset to get the first item of the tensor. Note: offset can be negative, in particular for slices.</li>
<li><tt class="docutils literal"><span class="pre">storage</span></tt>: An opaque data storage for the tensor</li>
</ul>
</dd>
</dl>
<p>Fields are public so that external libraries can easily construct a Tensor. You can use <tt class="docutils literal"><span class="pre">.data</span></tt> to access the opaque data storage.</p>
<dl class="docutils"><dt>Warning ⚠:</dt>
<dd>Assignment <pre class="listing"> a = b</pre> does not copy the data. Data modification on one tensor will be reflected on the other. However modification on metadata (shape, strides or offset) will not affect the other tensor. Explicit copies can be made with <tt class="docutils literal"><span class="pre">clone</span></tt>: <pre class="listing"> a = b.clone</pre></dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L32"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L32" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="CudaStorage"></a>
<dt><pre><a href="data_structure.html#CudaStorage"><span class="Identifier">CudaStorage</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">Flen</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>
  <span class="Identifier">Fdata</span><span class="Operator">*</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">UncheckedArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span>
  <span class="Identifier">Fref_tracking</span><span class="Operator">*</span><span class="Other">:</span> <span class="Keyword">ref</span> <span class="Other">[</span><span class="Keyword">ptr</span> <span class="Identifier">UncheckedArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">]</span>
</pre></dt>
<dd>

<p>Opaque seq-like structure for storage on the Cuda backend.</p>
<p>Nim garbage collector will automatically ask cuda to clear GPU memory if data becomes unused. </p>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L50"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L50" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="CudaTensor"></a>
<dt><pre><a href="data_structure.html#CudaTensor"><span class="Identifier">CudaTensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">shape</span><span class="Operator">*</span><span class="Other">:</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a>
  <span class="Identifier">strides</span><span class="Operator">*</span><span class="Other">:</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a>
  <span class="Identifier">offset</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>
  <span class="Identifier">storage</span><span class="Operator">*</span><span class="Other">:</span> <a href="data_structure.html#CudaStorage"><span class="Identifier">CudaStorage</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span>
</pre></dt>
<dd>

<dl class="docutils"><dt>Tensor data structure stored on Nvidia GPU (Cuda)</dt>
<dd><ul class="simple"><li><tt class="docutils literal"><span class="pre">shape</span></tt>: Dimensions of the CudaTensor</li>
<li><tt class="docutils literal"><span class="pre">strides</span></tt>: Numbers of items to skip to get the next item along a dimension.</li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: Offset to get the first item of the CudaTensor. Note: offset can be negative, in particular for slices.</li>
<li><tt class="docutils literal"><span class="pre">storage</span></tt>: An opaque data storage for the CudaTensor</li>
</ul>
</dd>
<dt>Warning ⚠:</dt>
<dd>Assignment <pre class="listing"> a = b</pre> does not copy the data. Data modification on one CudaTensor will be reflected on the other. However modification on metadata (shape, strides or offset) will not affect the other tensor. Explicit copies can be made with <tt class="docutils literal"><span class="pre">clone</span></tt>: <pre class="listing"> a = b.clone</pre></dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L60"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L60" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="ClStorage"></a>
<dt><pre><a href="data_structure.html#ClStorage"><span class="Identifier">ClStorage</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">Flen</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>
  <span class="Identifier">Fdata</span><span class="Operator">*</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">UncheckedArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span>
  <span class="Identifier">Fref_tracking</span><span class="Operator">*</span><span class="Other">:</span> <span class="Keyword">ref</span> <span class="Other">[</span><span class="Keyword">ptr</span> <span class="Identifier">UncheckedArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">]</span>
</pre></dt>
<dd>

Opaque seq-like structure for storage on the OpenCL backend.
&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L76"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L76" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="ClTensor"></a>
<dt><pre><a href="data_structure.html#ClTensor"><span class="Identifier">ClTensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">shape</span><span class="Operator">*</span><span class="Other">:</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a>
  <span class="Identifier">strides</span><span class="Operator">*</span><span class="Other">:</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a>
  <span class="Identifier">offset</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>
  <span class="Identifier">storage</span><span class="Operator">*</span><span class="Other">:</span> <a href="data_structure.html#ClStorage"><span class="Identifier">ClStorage</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span>
</pre></dt>
<dd>

<dl class="docutils"><dt>Tensor data structure stored on OpenCL (CPU, GPU, FPGAs or other accelerators)</dt>
<dd><ul class="simple"><li><tt class="docutils literal"><span class="pre">shape</span></tt>: Dimensions of the CudaTensor</li>
<li><tt class="docutils literal"><span class="pre">strides</span></tt>: Numbers of items to skip to get the next item along a dimension.</li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: Offset to get the first item of the CudaTensor. Note: offset can be negative, in particular for slices.</li>
<li><tt class="docutils literal"><span class="pre">storage</span></tt>: An opaque data storage for the CudaTensor</li>
</ul>
</dd>
<dt>Warning ⚠:</dt>
<dd>Assignment <pre class="listing"> a = b</pre> does not copy the data. Data modification on one CudaTensor will be reflected on the other. However modification on metadata (shape, strides or offset) will not affect the other tensor. Explicit copies can be made with <tt class="docutils literal"><span class="pre">clone</span></tt>: <pre class="listing"> a = b.clone</pre></dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L82"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L82" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="AnyTensor"></a>
<dt><pre><a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <a href="data_structure.html#Tensor"><span class="Identifier">Tensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Keyword">or</span> <a href="data_structure.html#CudaTensor"><span class="Identifier">CudaTensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span class="Keyword">or</span> <a href="data_structure.html#ClTensor"><span class="Identifier">ClTensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L98"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L98" class="link-seesrc" target="_blank" >Edit</a>

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="data,Tensor[T]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#data%2CTensor%5BT%5D"><span class="Identifier">data</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#Tensor"><span class="Identifier">Tensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">noInit</span></span><span class="Other">.}</span></span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L104"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L104" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="data,Tensor[T]_2"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#data%2CTensor%5BT%5D_2"><span class="Identifier">data</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="data_structure.html#Tensor"><span class="Identifier">Tensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">noInit</span></span><span class="Other">.}</span></span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L109"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L109" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="data=,Tensor[T],seq[T][T]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#data%3D%2CTensor%5BT%5D%2Cseq%5BT%5D%5BT%5D"><span class="Identifier">data=</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="data_structure.html#Tensor"><span class="Identifier">Tensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">noSideEffect</span></span><span class="Other">.}</span></span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L114"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L114" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="rank,AnyTensor"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#rank%2CAnyTensor"><span class="Identifier">rank</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<dl class="docutils"><dt>Input:</dt>
<dd><ul class="simple"><li>A tensor</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="simple"><li>Its rank</li>
</ul>
</dd>
<dt></dt>
<dd><ul class="simple"><li>0 for scalar (unfortunately cannot be stored)</li>
<li>1 for vector</li>
<li>2 for matrices</li>
<li>N for N-dimension array</li>
</ul>
</dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L123"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L123" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="size,AnyTensor"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#size%2CAnyTensor"><span class="Identifier">size</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<dl class="docutils"><dt>Input:</dt>
<dd><ul class="simple"><li>A tensor</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="simple"><li>The total number of elements it contains</li>
</ul>
</dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L135"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L135" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="shape_to_strides,MetadataArray,OrderType,MetadataArray"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#shape_to_strides%2CMetadataArray%2COrderType%2CMetadataArray"><span class="Identifier">shape_to_strides</span></a><span class="Other">(</span><span class="Identifier">shape</span><span class="Other">:</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a><span class="Other">;</span> <span class="Identifier">layout</span><span class="Other">:</span> <span class="Identifier">OrderType</span> <span class="Other">=</span> <span class="Identifier">rowMajor</span><span class="Other">;</span>
                     <span class="Identifier">result</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="metadataArray.html#MetadataArray"><span class="Identifier">MetadataArray</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<dl class="docutils"><dt>Input:</dt>
<dd><ul class="simple"><li>A shape (MetadataArray), for example [3,5] for a 3x5 matrix</li>
<li>Optionally rowMajor (C layout - default) or colMajor (Fortran)</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="simple"><li>The strides in C or Fortran order corresponding to this shape and layout</li>
</ul>
</dd>
</dl>
<p> Arraymancer defaults to rowMajor. Temporarily, CudaTensors are colMajor by default.</p>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L142"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L142" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="is_C_contiguous,AnyTensor"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#is_C_contiguous%2CAnyTensor"><span class="Identifier">is_C_contiguous</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Check if the tensor follows C convention / is row major
&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L165"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L165" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="is_F_contiguous,AnyTensor"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#is_F_contiguous%2CAnyTensor"><span class="Identifier">is_F_contiguous</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Check if the tensor follows Fortran convention / is column major
&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L176"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L176" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="isContiguous,AnyTensor"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#isContiguous%2CAnyTensor"><span class="Identifier">isContiguous</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Check if the tensor is contiguous
&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L187"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L187" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="get_data_ptr,AnyTensor[T]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#get_data_ptr%2CAnyTensor%5BT%5D"><span class="Identifier">get_data_ptr</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">T</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<dl class="docutils"><dt>Input:</dt>
<dd><ul class="simple"><li>A tensor</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="simple"><li>A pointer to the real start of its data (no offset)</li>
</ul>
</dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L196"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L196" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="get_offset_ptr,AnyTensor[T]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#get_offset_ptr%2CAnyTensor%5BT%5D"><span class="Identifier">get_offset_ptr</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#AnyTensor"><span class="Identifier">AnyTensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">T</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<dl class="docutils"><dt>Input:</dt>
<dd><ul class="simple"><li>A tensor</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="simple"><li>A pointer to the offset start of its data</li>
</ul>
</dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L203"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L203" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="dataArray,Tensor[T]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#dataArray%2CTensor%5BT%5D"><span class="Identifier">dataArray</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="data_structure.html#Tensor"><span class="Identifier">Tensor</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">UncheckedArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">noSideEffect</span><span class="Other">,</span> <span class="Identifier">inline</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<dl class="docutils"><dt>Input:</dt>
<dd><ul class="simple"><li>A tensor</li>
</ul>
</dd>
<dt>Returns:</dt>
<dd><ul class="simple"><li>A pointer to the offset start of the data. Return value supports array indexing.</li>
</ul>
</dd>
</dl>

&nbsp;&nbsp;<a
href="https://github.com/mratsim/arraymancer/tree/version-1-0/src/tensor/data_structure.nim#L210"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/mratsim/arraymancer/edit/master/src/tensor/data_structure.nim#L210" class="link-seesrc" target="_blank" >Edit</a>

</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small>Made with Nim. Generated: 2020-01-08 23:22:14 UTC</small>
      </div>
    </div>
  </div>
</article>
</body>
</html>
